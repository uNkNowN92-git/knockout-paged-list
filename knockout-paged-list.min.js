var PagedList=function(e){return function(e){function r(e){var r=$(e.target).data("url");s.setUrl(r)}function t(e){if(void 0!==s.url()){s.loading(!0);var r=a(e);$.getJSON(s.url(),r,function(r){n(r,e)}).fail(u).always(function(){s.loading(!1)})}}function a(e){var r={page:s.pageNumber()+(e?1:0),perPage:s.entriesPerPage(),currentEntries:s.loadedEntries()};return s.activeSort()&&($.extend(r,{sortBy:s.activeSort().column,sortAsc:s.activeSort().asc,sortOnly:s.sortOnly()}),s.sortOnly(!1)),$.extend(r,s.query()),r}function n(e,r){e.data.length>0&&(r?(ko.utils.arrayPushAll(s.data(),e.data),s.pageNumber()<s.totalPages()&&s.pageNumber(s.pageNumber()+1)):(o(e),s.data(e.data))),s.totalEntries(e.details.totalEntries)}function o(e){if(0===s.header().length){var r=$.map(e.data[0],function(e,r){return r});s.header(r)}}function u(e,r,t){s.error({jqXHR:e,status:r,error:t})}function i(){void 0!==s.defaultUrl&&(s.setUrl(s.defaultUrl),s.queryOnLoad&&s.getList())}var s=this;s.queryOnLoad=void 0!==e.queryOnLoad?e.queryOnLoad:!0,s.defaultEntriesPerPage=e.entriesPerPage||5,s.defaultUrl=e.url,s.url=ko.observable(),s.data=ko.observableArray(),s.pageNumber=ko.observable(1),s.totalEntries=ko.observable(0),s.entriesPerPage=ko.observable(s.defaultEntriesPerPage),s.entries=ko.computed(function(){var e=(s.pageNumber()-1)*s.entriesPerPage();return s.data.slice(e,e+s.entriesPerPage())}),s.error=ko.observableArray(),s.loading=ko.observable(),s.query=ko.observableArray(),s.header=ko.observableArray(),s.sortOnly=ko.observable(),s.activeSort=ko.observableArray(),s.setUrl=function(e){s.url(void 0!==e?e:s.defaultUrl)},s.hasError=ko.computed(function(){return 0!==s.error().length}),s.errorCode=ko.computed(function(){return void 0!==s.error().jqXHR?s.error().jqXHR.status:null}),s.parserError=ko.computed(function(){return void 0!==s.error().status?"parsererror"===s.error().status:!1}),s.hasEntries=function(){return s.totalEntries()>0},s.totalPages=ko.computed(function(){return Math.ceil(s.totalEntries()/s.entriesPerPage())}),s.onFirstPage=ko.computed(function(){return 1===s.pageNumber()}),s.onLastPage=ko.computed(function(){return s.pageNumber()>=s.totalPages()}),s.showFirstEntriesEnabled=function(){return s.hasEntries()&&s.totalEntries()>s.defaultEntriesPerPage},s.firstEntriesCount=ko.computed(function(){return s.totalEntries()<s.entriesPerPage()?s.totalEntries():s.defaultEntriesPerPage}),s.previousItemsCount=ko.computed(function(){return s.defaultEntriesPerPage}),s.nextItemsCount=ko.computed(function(){return s.totalPages()-s.pageNumber()==1?s.totalEntries()-s.entriesPerPage()*(s.totalPages()-1):s.defaultEntriesPerPage}),s.shownAll=function(){return s.entriesPerPage()>=s.totalEntries()},s.loadedEntries=function(){return s.data().length},s.totalEntriesOnNextPage=function(){return(s.pageNumber()+2)*s.entriesPerPage()},s.firstPage=function(){s.pageNumber(1)},s.lastPage=function(){s.pageNumber(s.totalPages())},s.next=function(){s.pageNumber()<s.totalPages()&&(s.loadedEntries()<s.totalEntriesOnNextPage()&&s.loadedEntries()!=s.totalEntries()?t(!0):s.pageNumber(s.pageNumber()+1))},s.previous=function(){0!==s.pageNumber()&&s.pageNumber(s.pageNumber()-1)},s.showFirstEntries=function(){s.pageNumber(1),s.entriesPerPage(s.defaultEntriesPerPage)},s.showAll=function(){s.pageNumber(1),s.entriesPerPage(s.totalEntries()),s.loadedEntries()<s.totalEntries()&&t()},s.sort=function(e,a,n){if(r(n),-1!==$.inArray(e,s.header())){var o={column:e,asc:!0};s.activeSort().column===e&&(o.asc=!s.activeSort().asc),s.activeSort(o),s.sortOnly(!0),t()}},s.getList=function(e,a){r(a),s.pageNumber(1),s.entriesPerPage(s.defaultEntriesPerPage),t()},i()}}();